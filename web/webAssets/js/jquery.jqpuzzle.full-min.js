!function($){$.fn.jqPuzzle=function(e,r){var i=0,a=0,t={rows:4,cols:4,hole:16,shuffle:!1,numbers:!0,language:"en",control:{shufflePieces:!0,confirmShuffle:!0,toggleOriginal:!0,toggleNumbers:!0,counter:!0,timer:!0,pauseTimer:!1},success:{fadeOriginal:!0,callback:void 0,callbackTimeout:300},animation:{shuffleRounds:3,shuffleSpeed:300,slidingSpeed:200,fadeOriginalSpeed:600},style:{gridSize:2,overlap:!0,backgroundOpacity:.1}},o={en:{shuffleLabel:"Shuffle",toggleOriginalLabel:"Original",toggleNumbersLabel:"Numbers",confirmShuffleMessage:"Do you really want to shuffle?",movesLabel:"moves",secondsLabel:"seconds"},fr:{shuffleLabel:"Mélanger",toggleOriginalLabel:"Original",toggleNumbersLabel:"Nombres",confirmShuffleMessage:"Veux-tu vraiment mélanger?",movesLabel:"mouvements",secondsLabel:"secondes"},de:{shuffleLabel:"Mischen",toggleOriginalLabel:"Original",toggleNumbersLabel:"Nummern",confirmShuffleMessage:"Willst du wirklich mischen?",movesLabel:"Züge",secondsLabel:"Sekunden"},pt:{shuffleLabel:"Embaralhar",toggleOriginalLabel:"Original",toggleNumbersLabel:"Numeros",confirmShuffleMessage:"Tem certeza que deseja reembralhar?",movesLabel:"movimentos",secondsLabel:"segundos"}};e&&!e.hole&&(e.rows||e.cols)&&(e.hole=(e.rows||t.rows)*(e.cols||t.cols)),e=$.extend(!0,{},t,e),r=$.extend(o[e.language]||o[t.language],r);var n=e.rows,s=e.cols,l=e.hole,d=e.control,p=e.success,c=e.animation,u=e.style;(n<3||n>9)&&(n=t.rows),(s<3||s>9)&&(s=t.rows),(l>n*s||l<1)&&(l=n*s),l--,c.slidingSpeed<1&&(c.slidingSpeed=1),c.shuffleSpeed<1&&(c.shuffleSpeed=1),c.fadeOriginalSpeed<1&&(c.fadeOriginalSpeed=1),c.shuffleRounds<1&&(c.shuffleRounds=1);var f=function(e){for(var r=0;r<e.length;r++){var i=r<l?r:r+1;if(e.eq(r).attr("current")!=i)return!1}return!0},g=function(e){for(var r=1,i=1;i<=n*s-1;i++)for(var a=i+1;a<=n*s;a++)r*=(e[i-1]-e[a-1])/(i-a);return 1==Math.round(r)},h=function(e,r){return parseInt(e)*s+parseInt(r)},b=function(e){return{row:Math.floor(e/s),col:e%s}},m=function(e){var r=e.css("border-left-width");if("none"!=e.css("border-left-style"))switch(r){case"thin":return 2;case"medium":return 4;case"thick":return 6;default:return parseInt(r)||0}return 0},v=function(e,r){var i,a,t=0,o,n=function(){s((new Date).getTime()),o=setTimeout(n,e)},s=function(e){r(e-t-i)};this.start=function(){if(i)return!1;i=(new Date).getTime(),n()},this.stop=function(){if(!i)return!1;clearTimeout(o);var e=(new Date).getTime();a&&(t+=e-a),s(e),i=a=void 0,t=0},this.pause=function(){if(!i||a)return!1;clearTimeout(o),a=(new Date).getTime()},this.resume=function(){if(!a)return!1;t+=(new Date).getTime()-a,a=void 0,n()}};return this.filter("img").each(function(){var t=$(this),o=!1,w=0,q=0,j,S=e.shuffle,O,x=l,T=$("<div/>").addClass("jqp-piece"),C=$("<div/>").addClass("jqp-wrapper").append(T),k=$("<div/>").attr("class",t.attr("class")||"").addClass("jqPuzzle").append(C);t.replaceWith(k),k.attr("id",t.attr("id")||"");var y={gui:{border:m(k),padding:{left:parseInt(k.css("padding-left"))||0,right:parseInt(k.css("padding-right"))||0,top:parseInt(k.css("padding-top"))||0,bottom:parseInt(k.css("padding-bottom"))||0}},wrapper:{border:m(C),padding:parseInt(C.css("padding-left"))||0},piece:{border:m(T)}};k.removeAttr("id"),k.replaceWith(t),t.one("load",function(){var m=0===u.gridSize&&u.overlap,T=s*(2*y.piece.border)+(s-1)*u.gridSize,C=n*(2*y.piece.border)+(n-1)*u.gridSize;m&&(T-=(s-1)*y.piece.border,C-=(n-1)*y.piece.border),t.css({width:"auto",height:"auto",visibility:"visible"});var k=Math.floor((t.width()-T)/s),L=Math.floor((t.height()-C)/n);if(k<30||L<30)return!1;for(var z=s*k+T,M=n*L+C,N=t.attr("src"),I=k+2*y.piece.border+u.gridSize,F=L+2*y.piece.border+u.gridSize,P={piece:$.boxModel?0:2*y.piece.border,wrapper:$.boxModel?0:2*(y.wrapper.border+y.wrapper.padding),gui:{width:$.boxModel?0:2*y.gui.border+y.gui.padding.left+y.gui.padding.right,height:$.boxModel?0:2*y.gui.border+y.gui.padding.top+y.gui.padding.bottom}},D=function(e,r){var i={left:y.wrapper.padding+r*I,top:y.wrapper.padding+e*F};return m&&(i.left-=r*y.piece.border,i.top-=e*y.piece.border),i},A=function(e,i){if(i){if(U.is(".jqp-disabled"))return!1;if(o)return!1;if(d.confirmShuffle&&w>0&&!window.confirm(r.confirmShuffleMessage))return!1;o=!0,j&&(se.removeClass("jqp-solved"),J.fadeTo(c.fadeOriginalSpeed,u.backgroundOpacity,function(){J.remove().prependTo(R),ee.removeClass("jqp-disabled")}))}O&&O.stop(),j=!1,S=!0,w=0,q=0,re&&re.removeClass("jqp-disabled"),ie&&ie.val(w),ae&&ae.val(q);for(var a=[],t=0;t<e;){for(var p=[],f=0;f<n*s;f++)p[f]=f;p.splice(l,1),a[t]=[];for(var f=0;f<n*s;f++)if(f!=l){var h=Math.floor(Math.random()*p.length);a[t][f]=p[h],p.splice(h,1)}else a[t][f]=l;(t+1<e||g(a[t]))&&t++}for(var m=0,t=0;t<e;t++)for(var v=t+1==e,f=0;f<a[t].length;f++)if(f!=l){var T=a[t][f];T>l&&(T-=1);var C=B.eq(T),k=b(f),y=D(k.row,k.col);v&&C.attr("current",f.toString()),void 0===i?C.css({left:y.left,top:y.top}):C.animate({left:y.left,top:y.top},i,null,function(){++m==c.shuffleRounds*(n*s-1)&&(o=!1,m=0)})}else v&&(x=l)},R=$("<div/>").addClass("jqp-wrapper").css({width:z+P.wrapper,height:M+P.wrapper,borderWidth:y.wrapper.border,padding:y.wrapper.padding,margin:0,position:"relative",overflow:"hidden",display:"block",visibility:"inherit"}),W=$("<div/>").addClass("jqp-piece").css({width:k+P.piece,height:L+P.piece,backgroundImage:"url("+N+")",borderWidth:y.piece.border,margin:0,padding:0,position:"absolute",overflow:"hidden",display:"block",visibility:"inherit",cursor:"default"}).append($("<span/>")),B=$([]),E=0;E<n;E++)for(var H=0;H<s;H++){var V=h(E,H);if(V!=l){var Z=D(E,H),G=-1*(H*I+y.piece.border),Q=-1*(E*F+y.piece.border);m&&(G+=H*y.piece.border,Q+=E*y.piece.border),B=B.add(W.clone().css({left:Z.left,top:Z.top,backgroundPosition:G+"px "+Q+"px"}).attr("current",String(V)).appendTo(R).children().text(V+1).end())}}e.shuffle&&A(1);var J=$("<div/>").css({width:z,height:M,left:y.wrapper.padding,top:y.wrapper.padding,backgroundImage:"url("+N+")",borderWidth:0,margin:0,padding:0,position:"absolute",opacity:u.backgroundOpacity}).prependTo(R),K=$("<div/>").addClass("jqp-controls").css({visibility:"inherit",display:"block",position:"static"}),U,X,Y,_=$("<a/>").css("cursor","default");d.shufflePieces&&(U=_.clone().text(r.shuffleLabel).appendTo(K),U.data("comenzar",1)),d.toggleOriginal&&(X=_.clone().text(r.toggleOriginalLabel).appendTo(K)),d.toggleNumbers&&(Y=_.clone().text(r.toggleNumbersLabel).appendTo(K),e.numbers&&Y.addClass("jqp-toggle"));var ee=K.children(),re,ie,ae;if(d.counter||d.timer){re=$("<span/>").css("cursor","default").appendTo(K);var te=$("<input/>").val(0).css({width:"5ex",cursor:"default"}).attr("readonly","readonly");d.counter&&(ie=te.clone().appendTo(re).after(r.movesLabel+" ")),d.timer&&(ae=te.clone().appendTo(re).after(r.secondsLabel)),e.shuffle||re.addClass("jqp-disabled")}var oe=$("<a/>").text("RAINBOW PAGES").attr("href","http://rainbowpages.lk").css({float:"right",fontFamily:"Verdana, Arial, Helvetica, sans-serif",fontSize:"9px",lineHeight:"12px",textDecoration:"none",color:"#FFFFFF",backgroundColor:"#777777",backgroundImage:"none",borderBottom:"1px dotted #FFFFFF",padding:"1px 3px 2px",marginRight:y.wrapper.border,position:"static",display:"inline",visibility:"inherit"}),ne=$("<div/>").css({width:z+2*(y.wrapper.padding+y.wrapper.border),position:"absolute",display:"block",visibility:"inherit",margin:"0px",padding:"0px",backgroundColor:"transparent"}).append(K),se=$("<div/>").attr("class",t.attr("class")||"").addClass("jqPuzzle").css({width:z+2*(y.wrapper.padding+y.wrapper.border)+P.gui.width,height:M+2*(y.wrapper.padding+y.wrapper.border)+P.gui.height,textAlign:"left",overflow:"hidden",display:"block"}).append(R).append(ne);t.replaceWith(se);var le=t.attr("id");le&&se.attr("id",le),e.numbers||B.children().hide(),re&&re.children("input").val(0);var de=se.height(),pe=ne.height();se.height(se.height()+ne.height()),ee.mousedown(function(){$(this).is(".jqp-disabled")||$(this).addClass("jqp-down")}),ee.mouseout(function(){$(this).removeClass("jqp-down")}),ee.mouseup(function(){$(this).removeClass("jqp-down")}),B.click(function(){if(o)return!1;if(j)return!1;o=!0;var e=$(this),r=e.attr("current"),t=b(r),n=b(x);if(Math.abs(t.row-n.row)+Math.abs(t.col-n.col)!=1)return o=!1,!1;var s=D(n.row,n.col);e.attr("current",String(x)),x=r,S&&w++,ie&&ie.val(w),i=w,1==w&&(O||(O=new v(333,function(e){q=Math.floor(e/1e3),ae&&ae.val(q),a=q})),O.start()),e.animate({left:s.left,top:s.top},c.slidingSpeed,null,function(){S?(j=f(B),j?(O&&O.stop(),S=!1,se.addClass("jqp-solved"),$("#btnSave").css("display","block"),window.setTimeout(ce,100)):o=!1):o=!1})}),d.shufflePieces&&U.click(function(){A(c.shuffleRounds,c.shuffleSpeed)}),d.toggleOriginal&&X.click(function(){return!X.is(".jqp-disabled")&&(!o&&(o=!0,X.is(".jqp-toggle")?(d.shufflePieces&&U.removeClass("jqp-disabled"),d.toggleNumbers&&Y.removeClass("jqp-disabled"),X.removeClass("jqp-toggle"),J.fadeTo(c.fadeOriginalSpeed,u.backgroundOpacity,function(){$(this).prependTo(R),d.pauseTimer&&O&&O.resume(),o=!1})):(d.shufflePieces&&U.addClass("jqp-disabled"),d.toggleNumbers&&Y.addClass("jqp-disabled"),X.addClass("jqp-toggle"),d.pauseTimer&&O&&O.pause(),J.appendTo(R).fadeTo(c.fadeOriginalSpeed,1,function(){o=!1})),!1))}),d.toggleNumbers&&Y.click(function(){if(Y.is(".jqp-disabled"))return!1;Y.is(".jqp-toggle")?(Y.removeClass("jqp-toggle"),B.children().hide()):(Y.addClass("jqp-toggle"),B.children().show())});var ce=function(){p.fadeOriginal?(d.toggleOriginal&&X.addClass("jqp-disabled"),d.toggleNumbers&&Y.addClass("jqp-disabled"),J.appendTo(R).fadeTo(c.fadeOriginalSpeed,1,function(){o=!1,ue()})):(o=!1,ue())},ue=function(){$.isFunction(p.callback)&&setTimeout(function(){p.callback({moves:w,seconds:q})},p.callbackTimeout)}});var L=setInterval(function(){t[0].complete&&(clearInterval(L),t.trigger("load"))},333)}).end()},$(document).ready(function(){$("img.jqPuzzle").each(function(){var e=/\bjqp(-[a-z]{2})?-r(\d)-c(\d)(-h(\d+))?(-s(\d+))?(-[A-Z]+)?\b/,r=e.exec(this.className),i;r&&(i={rows:parseInt(r[2]),cols:parseInt(r[3]),hole:parseInt(r[5])||null,shuffle:r[8]&&-1!=r[8].indexOf("S"),numbers:!r[8]||-1==r[8].indexOf("N"),language:r[1]&&r[1].substring(1)},r[7]&&(i.animation={},i.animation.shuffleRounds=parseInt(r[7])),r[8]&&-1!=r[8].search(/[ABCDE]/)&&(i.control={},i.control.shufflePieces=-1==r[8].indexOf("A"),i.control.toggleOriginal=-1==r[8].indexOf("B"),i.control.toggleNumbers=-1==r[8].indexOf("C"),i.control.counter=-1==r[8].indexOf("D"),i.control.timer=-1==r[8].indexOf("E"))),$(this).jqPuzzle(i)})})}(jQuery);